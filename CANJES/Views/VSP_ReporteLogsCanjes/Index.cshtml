@*@model IEnumerable<CANJES.Models.VSP_ReporteLogsCanjes>*@
@model IEnumerable<CANJES.Models.ClsReporteLogs>


@{
    ViewBag.Title = "Reporte de logs de canjes";
}

@*datatables*@
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.css">
<link href="https://cdn.datatables.net/buttons/1.6.4/css/buttons.dataTables.min.css" rel="stylesheet" type="text/css" />

<style>
    .dataTables_wrapper .dataTables_length {
        float: left !important;
    }
</style>

<h2 class="text-primary">@ViewBag.Title</h2>

@*<p>
        @Html.ActionLink("Create New", "Create")
    </p>*@
<div class="card mb-3">
    <div class="card-body">
        <div class="form-row">
            <label class="col-md-12 ml-2 text-primary"><span class="badge badge-pill badge-secondary">*</span> Seleccione valores para los filtros:</label>
        </div>
        <form action="VSP_ReporteLogsCanjes/filtrarLista" method="post">
            <div class="row">
                <div class="col-md-6 mb-3">
                    @Html.DropDownList("id_sociedad2", new SelectList(string.Empty, "Value", "Text"), "---Seleccione sociedad---", htmlAttributes: new { @class = "form-control", maxlength = 150 })
                </div>
                @*<div class="col-md-6 mb-3">
                        @Html.DropDownList("id_centro", new SelectList(string.Empty, "Value", "Text"), "---Seleccione centro---", htmlAttributes: new { @class = "form-control", maxlength = 150 })
                    </div>*@
            </div>
            @*<div class="row">
                    <div class="col-md-6 mb-3">
                        @Html.DropDownList("id_grupo", new SelectList(string.Empty, "Value", "Text"), "---Seleccione sociedad---", htmlAttributes: new { @class = "form-control", maxlength = 150 })
                    </div>
                    <div class="col-md-6 mb-3">
                        @Html.DropDownList("id_grupo2", new SelectList(string.Empty, "Value", "Text"), "---Seleccione sociedad---", htmlAttributes: new { @class = "form-control", maxlength = 150 })
                    </div>
                </div>*@
            <div class="row">
                <div class="col-md-4">
                    <label class="text-left">Desde: </label>
                    <input type="datetime-local" id="Fecha_inicial" name="Fecha_inicial" class="form-control" />
                </div>
                <div class="col-md-4">
                    <label class="text-left">Hasta: </label>
                    <input type="datetime-local" id="Fecha_final" name="Fecha_final" class="form-control" />
                </div>
                <div class="col-md-4" style="margin-top: 1.9rem;">
                    <button class="btn btn-block btn-dark">Generar reporte</button>
                </div>
            </div>
        </form>
    </div>
</div>
<div class="c-table">
    <div class="table-responsive table-stripered ctable-hijo">
        <table id="table_id" class="display">
            <thead>
                <tr>
                    <th>
                        Cod_Prod_SAP
                    </th>
                    <th>
                        Nombre_Segun_Proveedor
                    </th>
                    <th>
                        Estado
                    </th>
                    <th>
                        Nombre_Cliente
                    </th>
                    <th>
                        Cantidad_Solicitada
                    </th>
                    <th>
                        UNIDAD
                    </th>
                    @*<th>
                            @Html.DisplayNameFor(model => model.Cantidad_Enviar)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Saldo_SAP)
                        </th>*@
                    <th>
                       Sociedad
                    </th>
                    <th>
                        Estado
                    </th>
                    @*<th>
                        Fecha
                    </th>*@
                    @*<th>
                            @Html.DisplayNameFor(model => model.Mensaje1)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Mensaje2)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Mensaje3)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Mensaje4)
                        </th>*@
                    <th>
                        Observaciones
                    </th>
                    @*<th></th>*@
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>
                            @Html.DisplayFor(modelItem => item.COD_ProdLAB)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.PRODUCTO)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Estado)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.nombreCliente)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Cant_sol)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Unidad)
                        </td>
                        @*<td>
                                @Html.DisplayFor(modelItem => item.Cantidad_Enviar)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Saldo_SAP)
                            </td>*@
                        <td>
                            @Html.DisplayFor(modelItem => item.ID_Sociedad)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Estado)
                        </td>
                        @*<td>
                            @Html.DisplayFor(modelItem => item.Fecha)
                        </td>*@
                        @*<td>
                                @Html.DisplayFor(modelItem => item.Mensaje1)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Mensaje2)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Mensaje3)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Mensaje4)
                            </td>*@
                        <td>
                            @Html.DisplayFor(modelItem => item.observacion)
                        </td>
                        @*<td>
                                @Html.ActionLink("Edit", "Edit", new { /* id=item.PrimaryKey */ }) |
                                @Html.ActionLink("Details", "Details", new { /* id=item.PrimaryKey */ }) |
                                @Html.ActionLink("Delete", "Delete", new { /* id=item.PrimaryKey */ })
                            </td>*@
                    </tr>
                }

            </tbody>

        </table>
    </div>
</div>



@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.js"></script>



    <script src="https://cdn.datatables.net/buttons/1.6.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.2/js/buttons.bootstrap4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.2/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.2/js/buttons.print.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.2/js/buttons.colVis.min.js"></script>


    @*para iniciar el datatable*@
    <script>
        $(document).ready(function () {
            $('#table_id').DataTable({
                "paging": true,
                "ordering": true,
                "info": true,
                "pagingType": "full_numbers",
                "searching": true,
                "pageLength": 10,
                "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                //Lenguaje:
                "language": {
                    "paginate": {
                        "first": "Primero",
                        "last": "Ultimo",
                        "previous": "Anterior",
                        "next": "Siguiente",
                    },
                    "info": "Mostrar Entradas de _START_ a _TOTAL_",
                    "infoEmpty": "Total de Entradas 0",
                    "infoFiltered": "Filtrado de _MAX_ entradas totales",
                    "lengthMenu": "Mostrar _MENU_ Entradas",
                    "search": "Filtrar"
                },
                //"fixedColumns": false,
                //"scrollCollapse": true,
                //"scrollY": "300px",
                //"scrollX": true
                //,
                dom: 'Blfrtip',
                buttons: [
                    {
                        extend: 'excel',
                        className: 'btn btn-default rounded-0',
                        text: '<i class="far fa-file-excel"></i> Exportar a excel',
                        exportOptions: {
                            columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
                        }
                    },
                    {
                        extend: 'pdf',
                        className: 'btn btn-default rounded-0',
                        text: '<i class="far fa-file-pdf" title= "Guardar como PDF"></i> Pdf',
                        orientation: 'landscape',
                        pageSize: 'LEGAL',
                        exportOptions: {
                            columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
                        }
                    }
                ]
            });

            // Traer información de Sociedades
            $.getJSON('/VSP_ReporteLogsCanjes/GetSociedades', function (data) {
                $.each(data, function () {
                    $('#id_sociedad2').append('<option value=' +
                        this.Value + '>' + this.Text + '</option>');
                });
            });


            //Traer información de Centtos
            $("#id_sociedad2").bind('click', function () {
                var id = $('select[id=id_sociedad2]').val();
                $('#id_centro').empty();
                $('#id_centro').val('');

                $.getJSON('/VSP_ReporteLogsCanjes/GetCentros', { sociedad_id: id }, function (data) {
                    $.each(data, function () {
                        $('#id_centro').append('<option value=' +
                            this.Value + '>' + this.Text + '</option>');
                    });
                });
            });

            //// Traer información de grupo articulos
            $.getJSON('/VSP_ReporteLogsCanjes/GetGRUPOPROD', function (data) {
                $.each(data, function () {
                    $('#id_grupo2').append('<option value=' +
                        this.Value + '>' + this.Text + '</option>');
                });
            });

            // Traer información de grupo articulos
            $.getJSON('/VSP_ReporteLogsCanjes/GetPaises', function (data) {
                $.each(data, function () {
                    $('#id_grupo').append('<option value=' +
                        this.Value + '>' + this.Text + '</option>');
                });
            });
        });
    </script>
}

